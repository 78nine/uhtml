function cov_2i457qu7rf(){var path="/home/ag/git/uhtml/esm/rabbit.js";var hash="35ad169da7fee5f9f608eb9c2a616a10dc620317";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/ag/git/uhtml/esm/rabbit.js",statementMap:{"0":{start:{line:9,column:15},end:{line:9,column:20}},"1":{start:{line:10,column:18},end:{line:10,column:29}},"2":{start:{line:12,column:20},end:{line:15,column:1}},"3":{start:{line:13,column:29},end:{line:13,column:55}},"4":{start:{line:14,column:2},end:{line:14,column:56}},"5":{start:{line:17,column:20},end:{line:59,column:1}},"6":{start:{line:18,column:15},end:{line:18,column:43}},"7":{start:{line:19,column:18},end:{line:19,column:44}},"8":{start:{line:20,column:13},end:{line:20,column:34}},"9":{start:{line:21,column:16},end:{line:21,column:18}},"10":{start:{line:22,column:17},end:{line:22,column:36}},"11":{start:{line:23,column:10},end:{line:23,column:11}},"12":{start:{line:24,column:15},end:{line:24,column:30}},"13":{start:{line:25,column:2},end:{line:57,column:3}},"14":{start:{line:26,column:17},end:{line:26,column:30}},"15":{start:{line:27,column:4},end:{line:28,column:36}},"16":{start:{line:28,column:6},end:{line:28,column:36}},"17":{start:{line:29,column:4},end:{line:56,column:5}},"18":{start:{line:33,column:6},end:{line:36,column:7}},"19":{start:{line:34,column:8},end:{line:34,column:59}},"20":{start:{line:35,column:8},end:{line:35,column:35}},"21":{start:{line:39,column:6},end:{line:48,column:7}},"22":{start:{line:40,column:8},end:{line:45,column:11}},"23":{start:{line:46,column:8},end:{line:46,column:37}},"24":{start:{line:47,column:8},end:{line:47,column:35}},"25":{start:{line:49,column:6},end:{line:55,column:7}},"26":{start:{line:53,column:8},end:{line:53,column:59}},"27":{start:{line:54,column:8},end:{line:54,column:35}},"28":{start:{line:58,column:2},end:{line:58,column:26}},"29":{start:{line:61,column:19},end:{line:66,column:1}},"30":{start:{line:62,column:27},end:{line:62,column:81}},"31":{start:{line:63,column:19},end:{line:63,column:59}},"32":{start:{line:64,column:18},end:{line:64,column:47}},"33":{start:{line:65,column:2},end:{line:65,column:38}},"34":{start:{line:68,column:24},end:{line:81,column:1}},"35":{start:{line:69,column:23},end:{line:69,column:27}},"36":{start:{line:70,column:18},end:{line:73,column:3}},"37":{start:{line:74,column:15},end:{line:74,column:42}},"38":{start:{line:75,column:35},end:{line:75,column:42}},"39":{start:{line:76,column:2},end:{line:77,column:18}},"40":{start:{line:77,column:4},end:{line:77,column:18}},"41":{start:{line:78,column:2},end:{line:79,column:20}},"42":{start:{line:79,column:4},end:{line:79,column:20}},"43":{start:{line:80,column:2},end:{line:80,column:14}},"44":{start:{line:83,column:20},end:{line:87,column:1}},"45":{start:{line:84,column:17},end:{line:84,column:44}},"46":{start:{line:85,column:2},end:{line:85,column:34}},"47":{start:{line:86,column:2},end:{line:86,column:16}},"48":{start:{line:89,column:15},end:{line:105,column:1}},"49":{start:{line:90,column:18},end:{line:90,column:22}},"50":{start:{line:91,column:23},end:{line:91,column:30}},"51":{start:{line:92,column:35},end:{line:92,column:39}},"52":{start:{line:93,column:18},end:{line:93,column:31}},"53":{start:{line:94,column:2},end:{line:95,column:62}},"54":{start:{line:95,column:4},end:{line:95,column:62}},"55":{start:{line:96,column:2},end:{line:96,column:14}},"56":{start:{line:97,column:2},end:{line:97,column:37}},"57":{start:{line:98,column:14},end:{line:98,column:22}},"58":{start:{line:99,column:2},end:{line:100,column:53}},"59":{start:{line:100,column:4},end:{line:100,column:53}},"60":{start:{line:101,column:35},end:{line:101,column:40}},"61":{start:{line:102,column:2},end:{line:103,column:26}},"62":{start:{line:102,column:15},end:{line:102,column:16}},"63":{start:{line:102,column:29},end:{line:102,column:36}},"64":{start:{line:103,column:4},end:{line:103,column:26}},"65":{start:{line:104,column:2},end:{line:104,column:52}},"66":{start:{line:107,column:20},end:{line:131,column:1}},"67":{start:{line:108,column:2},end:{line:130,column:3}},"68":{start:{line:108,column:15},end:{line:108,column:16}},"69":{start:{line:108,column:29},end:{line:108,column:35}},"70":{start:{line:109,column:17},end:{line:109,column:26}},"71":{start:{line:110,column:4},end:{line:129,column:5}},"72":{start:{line:114,column:6},end:{line:128,column:7}},"73":{start:{line:115,column:8},end:{line:115,column:48}},"74":{start:{line:141,column:2},end:{line:141,column:19}},"75":{start:{line:142,column:2},end:{line:142,column:27}},"76":{start:{line:143,column:2},end:{line:143,column:23}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:12,column:20},end:{line:12,column:21}},loc:{start:{line:12,column:40},end:{line:15,column:1}},line:12},"1":{name:"(anonymous_1)",decl:{start:{line:17,column:20},end:{line:17,column:21}},loc:{start:{line:17,column:40},end:{line:59,column:1}},line:17},"2":{name:"(anonymous_2)",decl:{start:{line:61,column:19},end:{line:61,column:20}},loc:{start:{line:61,column:39},end:{line:66,column:1}},line:61},"3":{name:"(anonymous_3)",decl:{start:{line:68,column:24},end:{line:68,column:25}},loc:{start:{line:68,column:40},end:{line:81,column:1}},line:68},"4":{name:"(anonymous_4)",decl:{start:{line:83,column:20},end:{line:83,column:21}},loc:{start:{line:83,column:40},end:{line:87,column:1}},line:83},"5":{name:"(anonymous_5)",decl:{start:{line:89,column:15},end:{line:89,column:16}},loc:{start:{line:89,column:40},end:{line:105,column:1}},line:89},"6":{name:"(anonymous_6)",decl:{start:{line:107,column:20},end:{line:107,column:21}},loc:{start:{line:107,column:47},end:{line:131,column:1}},line:107},"7":{name:"Hole",decl:{start:{line:140,column:16},end:{line:140,column:20}},loc:{start:{line:140,column:45},end:{line:144,column:1}},line:140}},branchMap:{"0":{loc:{start:{line:27,column:4},end:{line:28,column:36}},type:"if",locations:[{start:{line:27,column:4},end:{line:28,column:36}},{start:{line:27,column:4},end:{line:28,column:36}}],line:27},"1":{loc:{start:{line:29,column:4},end:{line:56,column:5}},type:"if",locations:[{start:{line:29,column:4},end:{line:56,column:5}},{start:{line:29,column:4},end:{line:56,column:5}}],line:29},"2":{loc:{start:{line:33,column:6},end:{line:36,column:7}},type:"if",locations:[{start:{line:33,column:6},end:{line:36,column:7}}],line:33},"3":{loc:{start:{line:49,column:6},end:{line:55,column:7}},type:"if",locations:[{start:{line:49,column:6},end:{line:55,column:7}},{start:{line:49,column:6},end:{line:55,column:7}}],line:49},"4":{loc:{start:{line:50,column:8},end:{line:51,column:54}},type:"binary-expr",locations:[{start:{line:50,column:8},end:{line:50,column:50}},{start:{line:51,column:8},end:{line:51,column:54}}],line:50},"5":{loc:{start:{line:62,column:27},end:{line:62,column:81}},type:"binary-expr",locations:[{start:{line:62,column:27},end:{line:62,column:50}},{start:{line:62,column:54},end:{line:62,column:81}}],line:62},"6":{loc:{start:{line:76,column:2},end:{line:77,column:18}},type:"if",locations:[{start:{line:76,column:2},end:{line:77,column:18}},{start:{line:76,column:2},end:{line:77,column:18}}],line:76},"7":{loc:{start:{line:78,column:2},end:{line:79,column:20}},type:"if",locations:[{start:{line:78,column:2},end:{line:79,column:20}},{start:{line:78,column:2},end:{line:79,column:20}}],line:78},"8":{loc:{start:{line:94,column:2},end:{line:95,column:62}},type:"if",locations:[{start:{line:94,column:2},end:{line:95,column:62}},{start:{line:94,column:2},end:{line:95,column:62}}],line:94},"9":{loc:{start:{line:99,column:2},end:{line:100,column:53}},type:"if",locations:[{start:{line:99,column:2},end:{line:100,column:53}},{start:{line:99,column:2},end:{line:100,column:53}}],line:99},"10":{loc:{start:{line:99,column:6},end:{line:99,column:70}},type:"binary-expr",locations:[{start:{line:99,column:6},end:{line:99,column:14}},{start:{line:99,column:19},end:{line:99,column:46}},{start:{line:99,column:50},end:{line:99,column:69}}],line:99},"11":{loc:{start:{line:104,column:9},end:{line:104,column:51}},type:"binary-expr",locations:[{start:{line:104,column:9},end:{line:104,column:13}},{start:{line:104,column:18},end:{line:104,column:50}}],line:104},"12":{loc:{start:{line:110,column:4},end:{line:129,column:5}},type:"if",locations:[{start:{line:110,column:4},end:{line:129,column:5}},{start:{line:110,column:4},end:{line:129,column:5}}],line:110},"13":{loc:{start:{line:110,column:8},end:{line:110,column:40}},type:"binary-expr",locations:[{start:{line:110,column:8},end:{line:110,column:32}},{start:{line:110,column:36},end:{line:110,column:40}}],line:110},"14":{loc:{start:{line:114,column:6},end:{line:128,column:7}},type:"if",locations:[{start:{line:114,column:6},end:{line:128,column:7}}],line:114}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},b:{"0":[0,0],"1":[0,0],"2":[0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"35ad169da7fee5f9f608eb9c2a616a10dc620317"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_2i457qu7rf=function(){return actualCoverage;};return actualCoverage;}cov_2i457qu7rf();import instrument from '../../node_modules/uparser/esm/index.js';import{isArray}from '../../node_modules/uarray/esm/index.js';import{persistent}from './uwire.js';import{cacheInfo}from'./cache.js';import{handlers}from'./handlers.js';import{createFragment,createPath,createWalker,importNode}from'./node.js';const prefix=(cov_2i457qu7rf().s[0]++,'isµ');const templates=(cov_2i457qu7rf().s[1]++,new WeakMap());cov_2i457qu7rf().s[2]++;const createEntry=(type,template)=>{cov_2i457qu7rf().f[0]++;const{content,updates}=(cov_2i457qu7rf().s[3]++,mapUpdates(type,template));cov_2i457qu7rf().s[4]++;return{type,template,content,updates,wire:null};};cov_2i457qu7rf().s[5]++;const mapTemplate=(type,template)=>{cov_2i457qu7rf().f[1]++;const text=(cov_2i457qu7rf().s[6]++,instrument(template,prefix));const content=(cov_2i457qu7rf().s[7]++,createFragment(text,type));const tw=(cov_2i457qu7rf().s[8]++,createWalker(content));const nodes=(cov_2i457qu7rf().s[9]++,[]);const length=(cov_2i457qu7rf().s[10]++,template.length-1);let i=(cov_2i457qu7rf().s[11]++,0);let search=(cov_2i457qu7rf().s[12]++,`${prefix}${i}`);cov_2i457qu7rf().s[13]++;while(i<length){const node=(cov_2i457qu7rf().s[14]++,tw.nextNode());cov_2i457qu7rf().s[15]++;if(!node){cov_2i457qu7rf().b[0][0]++;cov_2i457qu7rf().s[16]++;throw`bad template: ${text}`;}else{cov_2i457qu7rf().b[0][1]++;}cov_2i457qu7rf().s[17]++;if(node.nodeType===8){cov_2i457qu7rf().b[1][0]++;cov_2i457qu7rf().s[18]++;// The only comments to be considered are those
// which content is exactly the same as the searched one.
/* istanbul ignore else */if(node.textContent===search){cov_2i457qu7rf().b[2][0]++;cov_2i457qu7rf().s[19]++;nodes.push({type:'node',path:createPath(node)});cov_2i457qu7rf().s[20]++;search=`${prefix}${++i}`;}else{}}else{cov_2i457qu7rf().b[1][1]++;cov_2i457qu7rf().s[21]++;while(node.hasAttribute(search)){cov_2i457qu7rf().s[22]++;nodes.push({type:'attr',path:createPath(node),name:node.getAttribute(search)// svg: type === 'svg'
});cov_2i457qu7rf().s[23]++;node.removeAttribute(search);cov_2i457qu7rf().s[24]++;search=`${prefix}${++i}`;}cov_2i457qu7rf().s[25]++;if((cov_2i457qu7rf().b[4][0]++,/^(?:style|textarea)$/i.test(node.tagName))&&(cov_2i457qu7rf().b[4][1]++,node.textContent.trim()===`<!--${search}-->`)){cov_2i457qu7rf().b[3][0]++;cov_2i457qu7rf().s[26]++;nodes.push({type:'text',path:createPath(node)});cov_2i457qu7rf().s[27]++;search=`${prefix}${++i}`;}else{cov_2i457qu7rf().b[3][1]++;}}}cov_2i457qu7rf().s[28]++;return{content,nodes};};cov_2i457qu7rf().s[29]++;const mapUpdates=(type,template)=>{cov_2i457qu7rf().f[2]++;const{content,nodes}=(cov_2i457qu7rf().s[30]++,(cov_2i457qu7rf().b[5][0]++,templates.get(template))||(cov_2i457qu7rf().b[5][1]++,setTemplate(type,template)));const fragment=(cov_2i457qu7rf().s[31]++,importNode.call(document,content,true));const updates=(cov_2i457qu7rf().s[32]++,nodes.map(handlers,fragment));cov_2i457qu7rf().s[33]++;return{content:fragment,updates};};cov_2i457qu7rf().s[34]++;export const retrieve=(info,hole)=>{cov_2i457qu7rf().f[3]++;const{sub,stack}=(cov_2i457qu7rf().s[35]++,info);const counter=(cov_2i457qu7rf().s[36]++,{a:0,aLength:sub.length,i:0,iLength:stack.length});const wire=(cov_2i457qu7rf().s[37]++,unroll(info,hole,counter));const{a,i,aLength,iLength}=(cov_2i457qu7rf().s[38]++,counter);cov_2i457qu7rf().s[39]++;if(a<aLength){cov_2i457qu7rf().b[6][0]++;cov_2i457qu7rf().s[40]++;sub.splice(a);}else{cov_2i457qu7rf().b[6][1]++;}cov_2i457qu7rf().s[41]++;if(i<iLength){cov_2i457qu7rf().b[7][0]++;cov_2i457qu7rf().s[42]++;stack.splice(i);}else{cov_2i457qu7rf().b[7][1]++;}cov_2i457qu7rf().s[43]++;return wire;};cov_2i457qu7rf().s[44]++;const setTemplate=(type,template)=>{cov_2i457qu7rf().f[4]++;const result=(cov_2i457qu7rf().s[45]++,mapTemplate(type,template));cov_2i457qu7rf().s[46]++;templates.set(template,result);cov_2i457qu7rf().s[47]++;return result;};cov_2i457qu7rf().s[48]++;const unroll=(info,hole,counter)=>{cov_2i457qu7rf().f[5]++;const{stack}=(cov_2i457qu7rf().s[49]++,info);const{i,iLength}=(cov_2i457qu7rf().s[50]++,counter);const{type,template,values}=(cov_2i457qu7rf().s[51]++,hole);const unknown=(cov_2i457qu7rf().s[52]++,i===iLength);cov_2i457qu7rf().s[53]++;if(unknown){cov_2i457qu7rf().b[8][0]++;cov_2i457qu7rf().s[54]++;counter.iLength=stack.push(createEntry(type,template));}else{cov_2i457qu7rf().b[8][1]++;}cov_2i457qu7rf().s[55]++;counter.i++;cov_2i457qu7rf().s[56]++;unrollArray(info,values,counter);let entry=(cov_2i457qu7rf().s[57]++,stack[i]);cov_2i457qu7rf().s[58]++;if((cov_2i457qu7rf().b[10][0]++,!unknown)&&((cov_2i457qu7rf().b[10][1]++,entry.template!==template)||(cov_2i457qu7rf().b[10][2]++,entry.type!==type))){cov_2i457qu7rf().b[9][0]++;cov_2i457qu7rf().s[59]++;stack[i]=entry=createEntry(type,template);}else{cov_2i457qu7rf().b[9][1]++;}const{content,updates,wire}=(cov_2i457qu7rf().s[60]++,entry);cov_2i457qu7rf().s[61]++;for(let i=(cov_2i457qu7rf().s[62]++,0),{length}=(cov_2i457qu7rf().s[63]++,updates);i<length;i++){cov_2i457qu7rf().s[64]++;updates[i](values[i]);}cov_2i457qu7rf().s[65]++;return(cov_2i457qu7rf().b[11][0]++,wire)||(cov_2i457qu7rf().b[11][1]++,entry.wire=persistent(content));};cov_2i457qu7rf().s[66]++;const unrollArray=(info,values,counter)=>{cov_2i457qu7rf().f[6]++;cov_2i457qu7rf().s[67]++;for(let i=(cov_2i457qu7rf().s[68]++,0),{length}=(cov_2i457qu7rf().s[69]++,values);i<length;i++){const hole=(cov_2i457qu7rf().s[70]++,values[i]);cov_2i457qu7rf().s[71]++;if((cov_2i457qu7rf().b[13][0]++,typeof hole==='object')&&(cov_2i457qu7rf().b[13][1]++,hole)){cov_2i457qu7rf().b[12][0]++;cov_2i457qu7rf().s[72]++;// The only values to process are Hole and arrays.
// Accordingly, there is no `else` case to test.
/* istanbul ignore else */if(hole instanceof Hole){cov_2i457qu7rf().b[14][0]++;cov_2i457qu7rf().s[73]++;values[i]=unroll(info,hole,counter);}else{if(isArray(hole)){for(let i=0,{length}=hole;i<length;i++){const inner=hole[i];if(typeof inner==='object'&&inner&&inner instanceof Hole){const{sub}=info;const{a,aLength}=counter;if(a===aLength)counter.aLength=sub.push(cacheInfo());counter.a++;hole[i]=retrieve(sub[a],inner);}}}}}else{cov_2i457qu7rf().b[12][1]++;}}};/**
 * Holds all necessary details needed to render the content further on. 
 * @constructor
 * @param {string} type The hole type, either `html` or `svg`.
 * @param {string[]} template The template literals used to the define the content.
 * @param {Array} values Zero, one, or more interpolated values to render.
 */export function Hole(type,template,values){cov_2i457qu7rf().f[7]++;cov_2i457qu7rf().s[74]++;this.type=type;cov_2i457qu7rf().s[75]++;this.template=template;cov_2i457qu7rf().s[76]++;this.values=values;};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJhYmJpdC5qcyJdLCJuYW1lcyI6WyJpbnN0cnVtZW50IiwiaXNBcnJheSIsInBlcnNpc3RlbnQiLCJjYWNoZUluZm8iLCJoYW5kbGVycyIsImNyZWF0ZUZyYWdtZW50IiwiY3JlYXRlUGF0aCIsImNyZWF0ZVdhbGtlciIsImltcG9ydE5vZGUiLCJwcmVmaXgiLCJ0ZW1wbGF0ZXMiLCJXZWFrTWFwIiwiY3JlYXRlRW50cnkiLCJ0eXBlIiwidGVtcGxhdGUiLCJjb250ZW50IiwidXBkYXRlcyIsIm1hcFVwZGF0ZXMiLCJ3aXJlIiwibWFwVGVtcGxhdGUiLCJ0ZXh0IiwidHciLCJub2RlcyIsImxlbmd0aCIsImkiLCJzZWFyY2giLCJub2RlIiwibmV4dE5vZGUiLCJub2RlVHlwZSIsInRleHRDb250ZW50IiwicHVzaCIsInBhdGgiLCJoYXNBdHRyaWJ1dGUiLCJuYW1lIiwiZ2V0QXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwidGVzdCIsInRhZ05hbWUiLCJ0cmltIiwiZ2V0Iiwic2V0VGVtcGxhdGUiLCJmcmFnbWVudCIsImNhbGwiLCJkb2N1bWVudCIsIm1hcCIsInJldHJpZXZlIiwiaW5mbyIsImhvbGUiLCJzdWIiLCJzdGFjayIsImNvdW50ZXIiLCJhIiwiYUxlbmd0aCIsImlMZW5ndGgiLCJ1bnJvbGwiLCJzcGxpY2UiLCJyZXN1bHQiLCJzZXQiLCJ2YWx1ZXMiLCJ1bmtub3duIiwidW5yb2xsQXJyYXkiLCJlbnRyeSIsIkhvbGUiLCJpbm5lciJdLCJtYXBwaW5ncyI6Im1tVEFBQSxNQUFPQSxDQUFBQSxVQUFQLEtBQXVCLFNBQXZCLENBQ0EsT0FBUUMsT0FBUixLQUFzQixRQUF0QixDQUNBLE9BQVFDLFVBQVIsS0FBeUIsT0FBekIsQ0FFQSxPQUFRQyxTQUFSLEtBQXdCLFlBQXhCLENBQ0EsT0FBUUMsUUFBUixLQUF1QixlQUF2QixDQUNBLE9BQVFDLGNBQVIsQ0FBd0JDLFVBQXhCLENBQW9DQyxZQUFwQyxDQUFrREMsVUFBbEQsS0FBbUUsV0FB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QUFELENBQUosQ0FBU1ksS0FBVCxDQUFsQixDQUNELENBQ0YsQ0FDRixFQUNGLENBbkJELGtDQW9CRCxDQUNGLENBeEJELENBMEJBOzs7Ozs7R0FPQSxNQUFPLFNBQVNELENBQUFBLElBQVQsQ0FBY2pELElBQWQsQ0FBb0JDLFFBQXBCLENBQThCNEMsTUFBOUIsQ0FBc0Msa0RBQzNDLEtBQUs3QyxJQUFMLENBQVlBLElBQVosQ0FEMkMseUJBRTNDLEtBQUtDLFFBQUwsQ0FBZ0JBLFFBQWhCLENBRjJDLHlCQUczQyxLQUFLNEMsTUFBTCxDQUFjQSxNQUFkLENBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgaW5zdHJ1bWVudCBmcm9tICd1cGFyc2VyJztcbmltcG9ydCB7aXNBcnJheX0gZnJvbSAndWFycmF5JztcbmltcG9ydCB7cGVyc2lzdGVudH0gZnJvbSAndXdpcmUnO1xuXG5pbXBvcnQge2NhY2hlSW5mb30gZnJvbSAnLi9jYWNoZS5qcyc7XG5pbXBvcnQge2hhbmRsZXJzfSBmcm9tICcuL2hhbmRsZXJzLmpzJztcbmltcG9ydCB7Y3JlYXRlRnJhZ21lbnQsIGNyZWF0ZVBhdGgsIGNyZWF0ZVdhbGtlciwgaW1wb3J0Tm9kZX0gZnJvbSAnLi9ub2RlLmpzJztcblxuY29uc3QgcHJlZml4ID0gJ2lzwrUnO1xuY29uc3QgdGVtcGxhdGVzID0gbmV3IFdlYWtNYXA7XG5cbmNvbnN0IGNyZWF0ZUVudHJ5ID0gKHR5cGUsIHRlbXBsYXRlKSA9PiB7XG4gIGNvbnN0IHtjb250ZW50LCB1cGRhdGVzfSA9IG1hcFVwZGF0ZXModHlwZSwgdGVtcGxhdGUpO1xuICByZXR1cm4ge3R5cGUsIHRlbXBsYXRlLCBjb250ZW50LCB1cGRhdGVzLCB3aXJlOiBudWxsfTtcbn07XG5cbmNvbnN0IG1hcFRlbXBsYXRlID0gKHR5cGUsIHRlbXBsYXRlKSA9PiB7XG4gIGNvbnN0IHRleHQgPSBpbnN0cnVtZW50KHRlbXBsYXRlLCBwcmVmaXgpO1xuICBjb25zdCBjb250ZW50ID0gY3JlYXRlRnJhZ21lbnQodGV4dCwgdHlwZSk7XG4gIGNvbnN0IHR3ID0gY3JlYXRlV2Fsa2VyKGNvbnRlbnQpO1xuICBjb25zdCBub2RlcyA9IFtdO1xuICBjb25zdCBsZW5ndGggPSB0ZW1wbGF0ZS5sZW5ndGggLSAxO1xuICBsZXQgaSA9IDA7XG4gIGxldCBzZWFyY2ggPSBgJHtwcmVmaXh9JHtpfWA7XG4gIHdoaWxlIChpIDwgbGVuZ3RoKSB7XG4gICAgY29uc3Qgbm9kZSA9IHR3Lm5leHROb2RlKCk7XG4gICAgaWYgKCFub2RlKVxuICAgICAgdGhyb3cgYGJhZCB0ZW1wbGF0ZTogJHt0ZXh0fWA7XG4gICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IDgpIHtcbiAgICAgIC8vIFRoZSBvbmx5IGNvbW1lbnRzIHRvIGJlIGNvbnNpZGVyZWQgYXJlIHRob3NlXG4gICAgICAvLyB3aGljaCBjb250ZW50IGlzIGV4YWN0bHkgdGhlIHNhbWUgYXMgdGhlIHNlYXJjaGVkIG9uZS5cbiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBlbHNlICovXG4gICAgICBpZiAobm9kZS50ZXh0Q29udGVudCA9PT0gc2VhcmNoKSB7XG4gICAgICAgIG5vZGVzLnB1c2goe3R5cGU6ICdub2RlJywgcGF0aDogY3JlYXRlUGF0aChub2RlKX0pO1xuICAgICAgICBzZWFyY2ggPSBgJHtwcmVmaXh9JHsrK2l9YDtcbiAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB3aGlsZSAobm9kZS5oYXNBdHRyaWJ1dGUoc2VhcmNoKSkge1xuICAgICAgICBub2Rlcy5wdXNoKHtcbiAgICAgICAgICB0eXBlOiAnYXR0cicsXG4gICAgICAgICAgcGF0aDogY3JlYXRlUGF0aChub2RlKSxcbiAgICAgICAgICBuYW1lOiBub2RlLmdldEF0dHJpYnV0ZShzZWFyY2gpLFxuICAgICAgICAgIC8vIHN2ZzogdHlwZSA9PT0gJ3N2ZydcbiAgICAgICAgfSk7XG4gICAgICAgIG5vZGUucmVtb3ZlQXR0cmlidXRlKHNlYXJjaCk7XG4gICAgICAgIHNlYXJjaCA9IGAke3ByZWZpeH0keysraX1gO1xuICAgICAgfVxuICAgICAgaWYgKFxuICAgICAgICAvXig/OnN0eWxlfHRleHRhcmVhKSQvaS50ZXN0KG5vZGUudGFnTmFtZSkgJiZcbiAgICAgICAgbm9kZS50ZXh0Q29udGVudC50cmltKCkgPT09IGA8IS0tJHtzZWFyY2h9LS0+YFxuICAgICAgKXtcbiAgICAgICAgbm9kZXMucHVzaCh7dHlwZTogJ3RleHQnLCBwYXRoOiBjcmVhdGVQYXRoKG5vZGUpfSk7XG4gICAgICAgIHNlYXJjaCA9IGAke3ByZWZpeH0keysraX1gO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4ge2NvbnRlbnQsIG5vZGVzfTtcbn07XG5cbmNvbnN0IG1hcFVwZGF0ZXMgPSAodHlwZSwgdGVtcGxhdGUpID0+IHtcbiAgY29uc3Qge2NvbnRlbnQsIG5vZGVzfSA9IHRlbXBsYXRlcy5nZXQodGVtcGxhdGUpIHx8IHNldFRlbXBsYXRlKHR5cGUsIHRlbXBsYXRlKTtcbiAgY29uc3QgZnJhZ21lbnQgPSBpbXBvcnROb2RlLmNhbGwoZG9jdW1lbnQsIGNvbnRlbnQsIHRydWUpO1xuICBjb25zdCB1cGRhdGVzID0gbm9kZXMubWFwKGhhbmRsZXJzLCBmcmFnbWVudCk7XG4gIHJldHVybiB7Y29udGVudDogZnJhZ21lbnQsIHVwZGF0ZXN9O1xufTtcblxuZXhwb3J0IGNvbnN0IHJldHJpZXZlID0gKGluZm8sIGhvbGUpID0+IHtcbiAgY29uc3Qge3N1Yiwgc3RhY2t9ID0gaW5mbztcbiAgY29uc3QgY291bnRlciA9IHtcbiAgICBhOiAwLCBhTGVuZ3RoOiBzdWIubGVuZ3RoLFxuICAgIGk6IDAsIGlMZW5ndGg6IHN0YWNrLmxlbmd0aFxuICB9O1xuICBjb25zdCB3aXJlID0gdW5yb2xsKGluZm8sIGhvbGUsIGNvdW50ZXIpO1xuICBjb25zdCB7YSwgaSwgYUxlbmd0aCwgaUxlbmd0aH0gPSBjb3VudGVyO1xuICBpZiAoYSA8IGFMZW5ndGgpXG4gICAgc3ViLnNwbGljZShhKTtcbiAgaWYgKGkgPCBpTGVuZ3RoKVxuICAgIHN0YWNrLnNwbGljZShpKTtcbiAgcmV0dXJuIHdpcmU7XG59O1xuXG5jb25zdCBzZXRUZW1wbGF0ZSA9ICh0eXBlLCB0ZW1wbGF0ZSkgPT4ge1xuICBjb25zdCByZXN1bHQgPSBtYXBUZW1wbGF0ZSh0eXBlLCB0ZW1wbGF0ZSk7XG4gIHRlbXBsYXRlcy5zZXQodGVtcGxhdGUsIHJlc3VsdCk7XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5jb25zdCB1bnJvbGwgPSAoaW5mbywgaG9sZSwgY291bnRlcikgPT4ge1xuICBjb25zdCB7c3RhY2t9ID0gaW5mbztcbiAgY29uc3Qge2ksIGlMZW5ndGh9ID0gY291bnRlcjtcbiAgY29uc3Qge3R5cGUsIHRlbXBsYXRlLCB2YWx1ZXN9ID0gaG9sZTtcbiAgY29uc3QgdW5rbm93biA9IGkgPT09IGlMZW5ndGg7XG4gIGlmICh1bmtub3duKVxuICAgIGNvdW50ZXIuaUxlbmd0aCA9IHN0YWNrLnB1c2goY3JlYXRlRW50cnkodHlwZSwgdGVtcGxhdGUpKTtcbiAgY291bnRlci5pKys7XG4gIHVucm9sbEFycmF5KGluZm8sIHZhbHVlcywgY291bnRlcik7XG4gIGxldCBlbnRyeSA9IHN0YWNrW2ldO1xuICBpZiAoIXVua25vd24gJiYgKGVudHJ5LnRlbXBsYXRlICE9PSB0ZW1wbGF0ZSB8fCBlbnRyeS50eXBlICE9PSB0eXBlKSlcbiAgICBzdGFja1tpXSA9IChlbnRyeSA9IGNyZWF0ZUVudHJ5KHR5cGUsIHRlbXBsYXRlKSk7XG4gIGNvbnN0IHtjb250ZW50LCB1cGRhdGVzLCB3aXJlfSA9IGVudHJ5O1xuICBmb3IgKGxldCBpID0gMCwge2xlbmd0aH0gPSB1cGRhdGVzOyBpIDwgbGVuZ3RoOyBpKyspXG4gICAgdXBkYXRlc1tpXSh2YWx1ZXNbaV0pO1xuICByZXR1cm4gd2lyZSB8fCAoZW50cnkud2lyZSA9IHBlcnNpc3RlbnQoY29udGVudCkpO1xufTtcblxuY29uc3QgdW5yb2xsQXJyYXkgPSAoaW5mbywgdmFsdWVzLCBjb3VudGVyKSA9PiB7XG4gIGZvciAobGV0IGkgPSAwLCB7bGVuZ3RofSA9IHZhbHVlczsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgaG9sZSA9IHZhbHVlc1tpXTtcbiAgICBpZiAodHlwZW9mIGhvbGUgPT09ICdvYmplY3QnICYmIGhvbGUpIHtcbiAgICAgIC8vIFRoZSBvbmx5IHZhbHVlcyB0byBwcm9jZXNzIGFyZSBIb2xlIGFuZCBhcnJheXMuXG4gICAgICAvLyBBY2NvcmRpbmdseSwgdGhlcmUgaXMgbm8gYGVsc2VgIGNhc2UgdG8gdGVzdC5cbiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBlbHNlICovXG4gICAgICBpZiAoaG9sZSBpbnN0YW5jZW9mIEhvbGUpXG4gICAgICAgIHZhbHVlc1tpXSA9IHVucm9sbChpbmZvLCBob2xlLCBjb3VudGVyKTtcbiAgICAgIGVsc2UgaWYgKGlzQXJyYXkoaG9sZSkpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIHtsZW5ndGh9ID0gaG9sZTsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgY29uc3QgaW5uZXIgPSBob2xlW2ldO1xuICAgICAgICAgIGlmICh0eXBlb2YgaW5uZXIgPT09ICdvYmplY3QnICYmIGlubmVyICYmIGlubmVyIGluc3RhbmNlb2YgSG9sZSkge1xuICAgICAgICAgICAgY29uc3Qge3N1Yn0gPSBpbmZvO1xuICAgICAgICAgICAgY29uc3Qge2EsIGFMZW5ndGh9ID0gY291bnRlcjtcbiAgICAgICAgICAgIGlmIChhID09PSBhTGVuZ3RoKVxuICAgICAgICAgICAgICBjb3VudGVyLmFMZW5ndGggPSBzdWIucHVzaChjYWNoZUluZm8oKSk7XG4gICAgICAgICAgICBjb3VudGVyLmErKztcbiAgICAgICAgICAgIGhvbGVbaV0gPSByZXRyaWV2ZShzdWJbYV0sIGlubmVyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG5cbi8qKlxuICogSG9sZHMgYWxsIG5lY2Vzc2FyeSBkZXRhaWxzIG5lZWRlZCB0byByZW5kZXIgdGhlIGNvbnRlbnQgZnVydGhlciBvbi4gXG4gKiBAY29uc3RydWN0b3JcbiAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIFRoZSBob2xlIHR5cGUsIGVpdGhlciBgaHRtbGAgb3IgYHN2Z2AuXG4gKiBAcGFyYW0ge3N0cmluZ1tdfSB0ZW1wbGF0ZSBUaGUgdGVtcGxhdGUgbGl0ZXJhbHMgdXNlZCB0byB0aGUgZGVmaW5lIHRoZSBjb250ZW50LlxuICogQHBhcmFtIHtBcnJheX0gdmFsdWVzIFplcm8sIG9uZSwgb3IgbW9yZSBpbnRlcnBvbGF0ZWQgdmFsdWVzIHRvIHJlbmRlci5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIEhvbGUodHlwZSwgdGVtcGxhdGUsIHZhbHVlcykge1xuICB0aGlzLnR5cGUgPSB0eXBlO1xuICB0aGlzLnRlbXBsYXRlID0gdGVtcGxhdGU7XG4gIHRoaXMudmFsdWVzID0gdmFsdWVzO1xufTtcbiJdfQ==